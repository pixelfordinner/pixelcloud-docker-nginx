map $http_x_forwarded_ssl $https_env {
    "" "$https";
    default "$http_x_forwarded_ssl";
}

map $http_x_forwarded_proto $scheme_env {
    "" "$scheme";
    default "$http_x_forwarded_proto";
}

map $http_x_real_ip $remote_addr_env {
    "" "$remote_addr";
    default "$http_x_real_ip";
}

map $http_x_forwarded_port $remote_port_env {
    "" "$remote_port";
    default "$http_x_forwarded_port";
}
